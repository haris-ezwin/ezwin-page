---
export interface Props {
  id?: string;
  title?: string;
  description?: string;
}

const {
  id = "popup-form",
  title = "Book Your Free Trial",
  description = "Fill in your details and we'll get back to you soon!",
} = Astro.props;
---

<div
  id={id}
  class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative">
    <!-- Close Button -->
    <button
      class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
      onclick={`document.getElementById('${id}').classList.add('hidden')`}>
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>

    <!-- Form Header -->
    <div class="mb-6">
      <h2 class="text-2xl font-bold text-gray-900 mb-2">{title}</h2>
      <p class="text-gray-600 text-sm">{description}</p>
    </div>

    <!-- Form -->
    <form class="space-y-4" id={`${id}-form`}>
      <div>
        <label
          for={`${id}-name`}
          class="block text-sm font-medium text-gray-700 mb-1">
          Name *
        </label>
        <input
          type="text"
          id={`${id}-name`}
          name="name"
          required
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="Your name"
        />
      </div>

      <div>
        <label
          for={`${id}-email`}
          class="block text-sm font-medium text-gray-700 mb-1">
          Email *
        </label>
        <input
          type="email"
          id={`${id}-email`}
          name="email"
          required
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="your@email.com"
        />
      </div>

      <div>
        <label
          for={`${id}-phone`}
          class="block text-sm font-medium text-gray-700 mb-1">
          Phone Number *
        </label>
        <input
          type="tel"
          id={`${id}-phone`}
          name="phone"
          required
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="+65 1234 5678"
        />
      </div>

      <div>
        <label
          for={`${id}-message`}
          class="block text-sm font-medium text-gray-700 mb-1">
          Message (Optional)
        </label>
        <textarea
          id={`${id}-message`}
          name="message"
          rows="3"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="Tell us about your needs..."></textarea>
      </div>

      <button
        type="submit"
        class="w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-blue-800 transition-colors duration-200">
        Submit
      </button>
    </form>
  </div>
</div>

<script define:vars={{ id }}>
  // Open popup function
  window[`open${id.replace(/-/g, "")}`] = function () {
    document.getElementById(id).classList.remove("hidden");
    document.getElementById(id).classList.add("flex");
  };

  // Close on outside click
  document.getElementById(id).addEventListener("click", function (e) {
    if (e.target === this) {
      this.classList.add("hidden");
      this.classList.remove("flex");
    }
  });
</script>
